# ==============================================================================
# Java Migration Accelerator - Environment Configuration
# ==============================================================================
# Copy this file to .env and fill in your actual values

# ==============================================================================
# GITHUB CONFIGURATION (for public and private repositories)
# ==============================================================================
# GitHub Personal Access Token (PAT) - REQUIRED for private repositories
# How to create: https://github.com/settings/tokens
# Required scopes: repo (full control), read:user
# Note: This is used as fallback when user doesn't provide their own token
GITHUB_TOKEN=ghp_your_github_token_here

# ==============================================================================
# GITLAB CONFIGURATION (for GitLab private repositories)
# ==============================================================================
# GitLab Personal Access Token - REQUIRED for private GitLab repos
# How to create: https://gitlab.com/-/user_settings/personal_access_tokens
# Required scopes: api, read_repository
GITLAB_TOKEN=glpat_your_gitlab_token_here

# GitLab Server URL (use https://gitlab.com for public GitLab)
GITLAB_URL=https://gitlab.com

# ==============================================================================
# EMAIL CONFIGURATION (for migration summaries)
# ==============================================================================
# SMTP Server for sending migration summary emails
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your_email@gmail.com
# Gmail: Use App Password (not regular password)
# See: https://support.google.com/accounts/answer/185833
SMTP_PASSWORD=your_app_password_here

# ==============================================================================
# SONARQUBE CONFIGURATION (optional - for code quality analysis)
# ==============================================================================
# SonarQube Cloud URL (or your self-hosted SonarQube instance)
SONARQUBE_URL=https://sonarcloud.io
# Personal access token for SonarQube
# Create at: https://sonarcloud.io/account/security/
SONARQUBE_TOKEN=d30612292ac2c11d6102fcbd2169989c6365748c
# SonarCloud organization key (required for SonarCloud)
# Find it in your SonarCloud organization settings
SONAR_ORG=sorimdevs-tech
SONAR_PROJECT_KEY=Rathinam288_sonar-demo

# ==============================================================================
# FOSSA CONFIGURATION (optional - for license and dependency scanning)
# ==============================================================================
# FOSSA API Key for license compliance analysis
FOSSA_API_KEY=your_fossa_api_key_here

# ==============================================================================
# APPLICATION CONFIGURATION
# ==============================================================================
# Working directory for cloning and processing repositories
WORK_DIR=/tmp/migrations

# ==============================================================================
# PRIVATE REPOSITORY ACCESS - HOW TO USE
# ==============================================================================
#
# METHOD 1: Using Default Token (Recommended for automated deployments)
# ──────────────────────────────────────────────────────────────────
# Set GITHUB_TOKEN or GITLAB_TOKEN in this .env file. The backend will
# automatically use these tokens when analyzing private repositories.
#
# Advantages:
# - Works automatically without user input
# - Ideal for CI/CD and server deployments
# - Higher GitHub API rate limits (5000/hour vs 60/hour)
#
# Example:
# GITHUB_TOKEN=ghp_xxxxxxxxxxxxxxxxxxxx
#
#
# METHOD 2: User-Provided Token (Recommended for web UI)
# ──────────────────────────────────────────────────────
# Users can provide their own personal access token through the web interface
# when starting a migration. This token is used only for that specific request.
#
# Advantages:
# - No need to store tokens on server
# - Each user uses their own credentials
# - Better for security and audit trail
# - Supports multiple user access patterns
#
# In the Migration Wizard:
# 1. Navigate to Step 1: "Select Repository"
# 2. Enter private repo URL (e.g., https://github.com/myorg/private-repo)
# 3. Paste your Personal Access Token in the "GitHub Token" field
# 4. Continue with migration
#
#
# METHOD 3: Fallback Chain
# ────────────────────────
# Backend tries tokens in this order:
# 1. User-provided token (highest priority)
# 2. Default token from GITHUB_TOKEN env var
# 3. Unauthenticated request (limited to 60 requests/hour - only for public repos)
#
#
# ==============================================================================
# CREATING GITHUB PERSONAL ACCESS TOKENS
# ==============================================================================
#
# For GitHub Enterprise/Self-hosted:
# 1. Go to https://github.com/settings/tokens
# 2. Click "Generate new token" → "Generate new token (classic)"
# 3. Name it: "Java Migration Accelerator"
# 4. Select scopes:
#    ☑ repo (Full control of private repositories)
#    ☑ read:user (Read user profile data)
#    ☑ read:org (Read organization data)
# 5. Click "Generate token"
# 6. Copy the token (starts with ghp_)
# 7. Paste into GITHUB_TOKEN below or provide in web UI
#
# Token Permissions Explained:
# - repo: Full control of private/public repositories (clone, read, push)
# - read:user: Access user profile information
# - read:org: Access organization repositories (if using org repos)
#
#
# ==============================================================================
# CREATING GITLAB PERSONAL ACCESS TOKENS
# ==============================================================================
#
# For GitLab.com or self-hosted GitLab:
# 1. Go to https://gitlab.com/-/user_settings/personal_access_tokens
# 2. Click "Create personal access token"
# 3. Name: "Java Migration Accelerator"
# 4. Select scopes:
#    ☑ api (Full API access including private repos)
#    ☑ read_repository (Read repository code)
# 5. Click "Create personal access token"
# 6. Copy the token (starts with glpat_)
# 7. Paste into GITLAB_TOKEN below or provide in web UI
#
#
# ==============================================================================
# PRIVATE REPO URL FORMATS
# ==============================================================================
#
# GitHub Private Repo:
# https://github.com/myusername/private-repo
# https://github.com/myorganization/private-repo
#
# GitLab Private Repo:
# https://gitlab.com/myusername/private-repo
# https://gitlab.com/mygroup/private-repo
#
# GitHub Enterprise:
# https://github.enterprise.com/myorg/private-repo
#
# Self-hosted GitLab:
# https://gitlab.mycompany.com/mygroup/private-repo
#
#
# ==============================================================================
# SECURITY BEST PRACTICES
# ==============================================================================
#
# 1. Never commit .env file to git (it's in .gitignore)
# 2. Keep tokens secure and rotate regularly
# 3. Use narrow-scoped tokens (only needed permissions)
# 4. For CI/CD: Use secrets management (GitHub Secrets, GitLab CI Variables)
# 5. For web UI: Users provide their own tokens (not stored on server)
# 6. Monitor token usage in GitHub/GitLab settings
#
#
# ==============================================================================
# TESTING PRIVATE REPO ACCESS
# ==============================================================================
#
# Using curl to test private repository access:
#
# With Personal Token (via header):
# $ curl -H "Authorization: token ghp_your_token" \
#   https://api.github.com/user/repos
#
# With Basic Auth (username + token as password):
# $ curl -u username:ghp_your_token \
#   https://api.github.com/user/repos
#
# Backend Test Endpoint:
# POST /api/github/repos
# Body: { "token": "ghp_your_token" }
#
#
# ==============================================================================
# TROUBLESHOOTING PRIVATE REPO ACCESS
# ==============================================================================
#
# Issue: "Repository not found" (401 Unauthorized)
# Solution:
# - Verify token has "repo" scope (not just public_repo)
# - Check token hasn't expired (60 days for web-flow tokens)
# - Confirm you have access to the repository
# - Try without trailing slash in repo URL
#
# Issue: "Bad credentials" (403 Forbidden)
# Solution:
# - Token might be invalid or expired
# - Regenerate token: https://github.com/settings/tokens
# - Check token starts with "ghp_" (GitHub) or "glpat_" (GitLab)
#
# Issue: "Rate limit exceeded"
# Solution:
# - Set GITHUB_TOKEN in .env for higher rate limits (5000/hour)
# - Without token, limited to 60 requests/hour
# - Wait 1 hour for rate limit to reset
#
# Issue: Private repo accessible but migration fails
# Solution:
# - Check migration logs for specific error
# - Verify Java version detection is working
# - Ensure repository has required build files (pom.xml, build.gradle)
#
